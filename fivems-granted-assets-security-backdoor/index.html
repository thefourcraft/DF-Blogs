<!DOCTYPE html><html lang="en-us"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><title>FiveM&#x27;s Granted Assets Security Backdoor</title><meta name="description" content="I have discovered a vulnerability within FiveM's content.cfx.re/assets system that allows unauthorized individuals to download content without needing authentication or being connected to cfx.re."><meta name="generator" content="Publii Open-Source CMS for Static Site"><script>window.publiiEmbedConsentCheck = function (cookieGroup) {
                var configName = 'publii-gdpr-allowed-cookies-v1';
                var lastConfigSave = localStorage.getItem('publii-gdpr-cookies-config-save-date');
                var configIsFresh = false;

                if (lastConfigSave !== null) {
                    lastConfigSave = parseInt(lastConfigSave, 10);

                    if (lastConfigSave === 0) {
                        configIsFresh = true;
                    } else if (30 > 0 && +new Date() - lastConfigSave < 30 * 24 * 60 * 60 * 1000) {
                        configIsFresh = true;
                    }
                }

                if (!configIsFresh) {
                    return;
                }

                var config = localStorage.getItem(configName);

                if (config && config.indexOf(cookieGroup) > -1) {
                    var iframesToUnlock = document.querySelectorAll('.pec-wrapper[data-consent-group-id="' + cookieGroup + '"]');

                    for (var i = 0; i < iframesToUnlock.length; i++) {
                        var iframeWrapper = iframesToUnlock[i];

                        if (iframeWrapper.getAttribute('data-consent-given') === 'true') {
                            continue;
                        }

                        iframeWrapper.setAttribute('data-consent-given', 'true');
                        iframeWrapper.querySelector('.pec-overlay').classList.remove('is-active');
                        iframeWrapper.querySelector('.pec-overlay').setAttribute('aria-hidden', 'true');
                        var iframe = iframeWrapper.querySelector('iframe');
                        iframe.setAttribute('src', iframe.getAttribute('data-consent-src'));
                    }
                }
            }</script><link rel="canonical" href="https://blog.thefourcraft.com/fivems-granted-assets-security-backdoor/"><link rel="alternate" type="application/atom+xml" href="https://blog.thefourcraft.com/feed.xml"><link rel="alternate" type="application/json" href="https://blog.thefourcraft.com/feed.json"><meta property="og:title" content="FiveM's Granted Assets Security Backdoor "><meta property="og:image" content="https://blog.thefourcraft.com/media/posts/44/FiveMs-Granted-Assets-Security-Backdoor.png"><meta property="og:image:width" content="1920"><meta property="og:image:height" content="1080"><meta property="og:site_name" content="DF Blogs"><meta property="og:description" content="I have discovered a vulnerability within FiveM's content.cfx.re/assets system that allows unauthorized individuals to download content without needing authentication or being connected to cfx.re."><meta property="og:url" content="https://blog.thefourcraft.com/fivems-granted-assets-security-backdoor/"><meta property="og:type" content="article"><meta property="fb:app_id" content="1574887919592240"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@thefourcraft"><meta name="twitter:title" content="FiveM's Granted Assets Security Backdoor "><meta name="twitter:description" content="I have discovered a vulnerability within FiveM's content.cfx.re/assets system that allows unauthorized individuals to download content without needing authentication or being connected to cfx.re."><meta name="twitter:image" content="https://blog.thefourcraft.com/media/posts/44/FiveMs-Granted-Assets-Security-Backdoor.png"><link rel="shortcut icon" href="https://blog.thefourcraft.com/media/website/logo.png" type="image/png"><link rel="preload" href="https://blog.thefourcraft.com/assets/dynamic/fonts/publicsans/publicsans.woff2" as="font" type="font/woff2" crossorigin><link rel="preload" href="https://blog.thefourcraft.com/assets/dynamic/fonts/oswald/oswald.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://blog.thefourcraft.com/assets/css/fontawesome-all.min.css?v=bbcde81f26378440dac4c3d195714389"><link rel="stylesheet" href="https://blog.thefourcraft.com/assets/css/style.css?v=355098d11bac9eeef8faecd493fe1e50"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.thefourcraft.com/fivems-granted-assets-security-backdoor/index.html"},"headline":"FiveM's Granted Assets Security Backdoor ","datePublished":"2023-05-14T02:24","dateModified":"2023-05-14T02:30","image":{"@type":"ImageObject","url":"https://blog.thefourcraft.com/media/posts/44/FiveMs-Granted-Assets-Security-Backdoor.png","height":1080,"width":1920},"description":"I have discovered a vulnerability within FiveM's content.cfx.re/assets system that allows unauthorized individuals to download content without needing authentication or being connected to cfx.re.","author":{"@type":"Person","name":"thefourCraft","url":"https://blog.thefourcraft.com/authors/david/"},"publisher":{"@type":"Organization","name":"thefourCraft"}}</script></head><body class="is-preload"><div id="wrapper"><div id="main"><div class="inner"><header id="header"><a class="logo" href="https://blog.thefourcraft.com/index.html"><strong>DF Blogs</strong></a><ul class="icons"><li><a href="https://twitter.com/thefourcraft" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li><li><a href="https://www.facebook.com/david2004furman" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li><li><a href="https://www.instagram.com/david_furman/" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li><li><a href="https://www.linkedin.com/in/david-furman/" class="icon brands fa-linkedin"><span class="label">LinkedIn</span></a></li><li><a href="https://github.com/thefourcraft" class="icon brands fa-github"><span class="label">[MISSING TRANSLATION]</span></a></li><li><a href="https://reddit.com/user/thefourcraft" class="icon brands fa-reddit"><span class="label">[MISSING TRANSLATION]</span></a></li></ul></header><article class="post"><header class="main post__header"><time datetime="2023-05-14T02:24" class="post__date">02:24:26 14/05/23</time><h1>FiveM&#x27;s Granted Assets Security Backdoor </h1></header><figure class="image main"><img src="https://blog.thefourcraft.com/media/posts/44/FiveMs-Granted-Assets-Security-Backdoor.png" srcset="https://blog.thefourcraft.com/media/posts/44/responsive/FiveMs-Granted-Assets-Security-Backdoor-xs.png 300w, https://blog.thefourcraft.com/media/posts/44/responsive/FiveMs-Granted-Assets-Security-Backdoor-sm.png 480w, https://blog.thefourcraft.com/media/posts/44/responsive/FiveMs-Granted-Assets-Security-Backdoor-md.png 768w, https://blog.thefourcraft.com/media/posts/44/responsive/FiveMs-Granted-Assets-Security-Backdoor-lg.png 1024w, https://blog.thefourcraft.com/media/posts/44/responsive/FiveMs-Granted-Assets-Security-Backdoor-xl.png 1360w, https://blog.thefourcraft.com/media/posts/44/responsive/FiveMs-Granted-Assets-Security-Backdoor-xxl.png 1600w" sizes="(max-width: 1600px) 100vw, 1600px" loading="lazy" height="1080" width="1920" alt=""></figure><div class="post__inner post__entry"><p>I have discovered a vulnerability within FiveM's content.cfx.re/assets system that allows unauthorized individuals to download content without needing authentication or being connected to cfx.re. This security flaw raises significant concerns about the platform's integrity and user data protection. I have made multiple attempts to communicate this issue to the FiveM team, but unfortunately, my efforts were ignored, leading me to disclose this vulnerability publicly.</p><p class="msg msg--warning">I hesitated to publish this blog post, as I encountered difficulties communicating with the FiveM or cfx.re team, who unfortunately chose to ignore me and blacklist me from their GitHub. Despite my persistent effort to establish contact, I have made my report and findings public.</p><h2>What is FiveM?</h2><p>FiveM is a modification framework for the famous Grand Theft Auto V (GTA V), developed by Rockstar Games. FiveM allows users to create and customize their own multiplayer experiences within the game, separate from the official GTA Online multiplayer mode.</p><p>With FiveM, players can create their dedicated servers and modify various aspects of the game, including adding new maps, vehicles, scripts, and game modes. It provides a platform for developers to build and share their custom multiplayer game modes, role-playing servers, and other creative content.</p><p>FiveM is widely used for role-playing servers. These role-playing servers often have rules and communities, offering a unique multiplayer experience. Players take on different roles and engage in activities such as police enforcement, emergency services, criminal enterprises, or simply interacting with other players in a virtual world.</p><p>It's worth noting that FiveM is a third-party modification and operates separately from the official GTA Online servers. It is not endorsed or supported by Rockstar Games. Still, it has gained significant popularity among the GTA V community due to its versatility and ability to create customized multiplayer environments.</p><h2>About the FiveM Asset Escrow Protection System</h2><p>The FiveM Asset Escrow Protection System, developed in collaboration with <a href="https://Tebex.com" target="_blank" rel="noopener noreferrer">Tebex</a>, offers a secure solution for resource authors within the FiveM community. Instead of relying on obfuscation or IP locking, this system encrypts resources and ensures purchase ownership. Authors can protect their code from leaks and unauthorized usage by uploading their zipped resources to the Keymaster 4.0k dashboard.<br>Tebex is the exclusive monetization partner, allowing creators to link their FiveM Assets directly to Tebex packages.<br>Customers who purchase content receive a download link and access management is handled through the keymaster dashboard.<br>This system provides an alternative that avoids performance slowdowns and security concerns associated with traditional protection methods. It encourages collaboration and open-source practices while offering resource developers control over their code and assets.</p><h2>So where is the security issue</h2><p>The security issue arises when downloading files from the Cfx.re Keymaster. Upon downloading a file, you can inspect its properties to find the "Where from" information, which reveals the original URL of the downloaded file. In the case of the Cfx.re Keymaster, the URL structure is similar to the following example:</p><pre><a href="https://content.cfx.re/assets/:asset-id/61e009eea9ffc702734527f676bf26e7?response-content-disposition=attachment%3B%20filename%20%3D%22andrada.zip%22&amp;X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&amp;X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=asset-storage%2F20230513%2Fcfx%2Fs3%2Faws4_request&amp;X-Amz-Date=20230513T150508Z&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Expires=600&amp;X-Amz-Signature=a50608224a501bee0e39447ad5bbbc97b1948c27fbe7ef23f476bbdb1fa20295" target="_new">https://content.cfx.re/assets/:asset-id/61e009eea9ffc702734527f676bf26e7?response-content-disposition=attachment%3B%20filename%20%3D%22andrada.zip%22&amp;X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&amp;X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=asset-storage%2F2023%2Fcfx%2Fs3%2Faws4_request&amp;X-Amz-Date=20230513T150508Z&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Expires=600&amp;X-Amz-Signature=a50608224a501bee0e39447ad5bbbc97b1948c27fbe7ef23f476bbdb1fa</a></pre><p>This URL contains sensitive information, such as the asset ID, file name, and various parameters related to the Amazon Web Services (AWS) authentication and access control. The security concern lies in the fact that this URL structure can be easily deduced, allowing unauthorized individuals to access and download content without proper authentication or being connected to cfx.re.</p><h3>Here's a breakdown of the URL</h3><ol><li><p>Base URL: <code>https://content.cfx.re/assets/</code></p><ul><li>This is the base URL for accessing assets on the Cfx.re Keymaster.</li></ul></li><li><p>Asset ID: <code>:asset-id</code></p><ul><li>This part should be replaced with the actual asset ID. It uniquely identifies the specific asset being accessed.</li></ul></li><li><p><strong>Query Parameters:</strong></p><ul><li><code>response-content-disposition=attachment%3B%20filename%20%3D%22andrada.zip%22</code>: Specifies the content disposition of the response, indicating that it should be treated as an attachment with the filename "andrada.zip".</li><li><code>X-Amz-Content-Sha256=UNSIGNED-PAYLOAD</code>: Used in AWS for the content's SHA-256 hash. In this case, it indicates that the payload is not signed.</li><li><code>X-Amz-Algorithm=AWS4-HMAC-SHA256</code>: Specifies the hashing algorithm used for authentication.</li><li><code>X-Amz-Credential=asset-storage%2F20234%2Fcfx%2Fs3%2Faws4_request</code>: Provides the AWS credentials for authentication, indicating the asset storage, date, service, and request type.</li><li><code>X-Amz-Date=20230513T150508Z</code>: Specifies the date and time of the request in UTC format.</li><li><code>X-Amz-SignedHeaders=host</code>: Indicates the headers signed as part of the authentication process.</li><li><code>X-Amz-Expires=600</code>: Specifies the expiration time for the URL in seconds. In this case, it is set to 600 seconds (10 minutes).</li><li><code>X-Amz-Signature=a50608224a501bee0e39447ad5bbbc97b1948c27fbe7ef23f476bbdb1fa23295</code>: The signature generated using the AWS secret key to authenticate the request.</li></ul></li></ol><p><br>This URL structure contains the necessary information for accessing and downloading a specific asset from the Cfx.re Keymaster while including authentication and access control parameters based on AWS authentication mechanisms.</p><h2>What is the issue here?</h2><p>The URL structure you provided exposes a critical security vulnerability within the Cfx.re Keymaster system. This vulnerability enables unauthorized individuals to bypass authentication and access and download content without proper authorization or being connected to cfx.re.<br><br>By deciphering the URL structure, individuals can obtain the asset ID and manipulate the URL to access and download various files hosted on the Keymaster platform. This presents a significant security risk as it allows unauthorized users to obtain sensitive files and data without going through the necessary authentication mechanisms.<br><br>The potential implications of this security flaw are far-reaching. It opens the door for unauthorized access to confidential information, intellectual property, personal data, or other content stored within the Cfx.re Keymaster. This could result in data breaches, unauthorized distribution of proprietary assets, or exposure of sensitive information to malicious actors.<br><br>Users rely on the secure handling and protection of their content when utilizing services like the Cfx.re Keymaster. However, this vulnerability exposes a weakness in the platform's security infrastructure, potentially compromising the confidentiality and integrity of the hosted content. Furthermore, this vulnerability undermines the platform's integrity and erodes user trust.<br><br>Given the critical nature of this vulnerability, <strong>it is essential for the FiveM or cfx.re team to address this issue promptly.</strong><br>They should prioritize investigating and resolving security flaws to prevent further unauthorized access and potential data breaches. Timely mitigation of this vulnerability will help safeguard user data, protect intellectual property, and maintain the trust of the user community.</p><h3>How can this massive security failure occur?</h3><p class="msg msg--warning">This section has a personal option</p><p>The recent discovery of a significant security failure within the Cfx.re Keymaster has raised concerns about the integrity and protection of user data. The question arises: how could such a massive security failure occur in the first place? Examining this vulnerability's circumstances sheds light on the potential factors contributing to its existence.</p><ol><li><p><strong>Lack of Vulnerability Assessment:</strong><br>It is possible that the FiveM or cfx.re team did not conduct comprehensive vulnerability assessments or security audits on their platform.<br>Security weaknesses and flaws can go unnoticed without these crucial assessments, leaving the system vulnerable to exploitation.</p></li><li><p><strong>Inadequate Secure Coding Practices:</strong><br>Insufficient emphasis on secure coding practices during development may have contributed to this security failure. Failure to follow established security guidelines and best practices can lead to vulnerabilities easily exploited by malicious actors.</p></li><li><p><strong>Limited Testing and Quality Assurance:</strong><br>Insufficient testing and quality assurance processes can result in undetected security vulnerabilities. If rigorous testing procedures were not in place, it becomes easier for security flaws to slip through the cracks, exposing the system to potential breaches.</p></li><li><p><strong>Inadequate Response to Reported Issues:</strong><br>The inability or unwillingness of the FiveM or cfx.re team to address reported security concerns is another possible cause. If users or researchers have previously alerted the group to potential vulnerabilities, disregarding or ignoring these reports can perpetuate the existence of the security flaw.</p></li><li><p><strong>The Complexity of System Architecture:<br></strong>The complexity of the Cfx.re Keymaster system may have inadvertently introduced vulnerabilities. As systems become more intricate, the likelihood of overlooking potential security weaknesses increases. Complex interactions between various components may create unexpected entry points for unauthorized access.</p></li><li><p><strong>Insufficient Security Training and Awareness:</strong><br>Inadequate security training and awareness among developers and system administrators can contribute to security failures. Without a deep understanding of security best practices and the latest threats, it becomes easier to overlook potential vulnerabilities during system development and maintenance.</p></li></ol><p>Organizations must prioritize robust security practices, including regular vulnerability assessments, secure coding guidelines, thorough testing, and prompt issue resolution. Fostering a culture of security awareness and investing in ongoing training can also help prevent such massive security failures in the future.</p><div class="group w-full text-gray-800 dark:text-gray-100 border-b border-black/10 dark:border-gray-900/50 bg-gray-50 dark:bg-[#444654]"><div class="flex p-4 gap-4 text-base md:gap-6 md:max-w-2xl lg:max-w-xl xl:max-w-3xl md:py-6 lg:px-0 m-auto"><div class="relative flex w-[calc(100%-50px)] flex-col gap-1 md:gap-3 lg:w-[calc(100%-115px)]"><div class="flex flex-grow flex-col gap-3"><div class="min-h-[20px] flex flex-col items-start gap-4 whitespace-pre-wrap break-words"><div class="markdown prose w-full break-words dark:prose-invert dark"><p>Addressing this security failure requires immediate action from the FiveM or cfx.re team. Conducting a thorough investigation, promptly fixing the vulnerability, and implementing measures to prevent similar issues in the future are essential steps toward restoring trust and safeguarding user data.</p></div></div></div></div></div></div><h3>Understanding the Security Concerns Surrounding FiveM</h3><p>FiveM, or cfx.re, has faced significant criticism regarding its security measures, prompting questions about its overall level of security. Several factors contribute to the perceived insecurity of the platform, which can be examined to understand the concerns.</p><ol><li><p><strong>Lack of Expertise and Experience:</strong><br>There are concerns that the team behind FiveM or cfx.re may consist of individuals with limited knowledge and experience in the security domain. Insufficient expertise in security practices and protocols can contribute to vulnerabilities and weaken the platform's overall security.</p></li><li><p><strong>Inadequate Attention to Security Standards:</strong><br>It is suggested that FiveM or cfx.re might not prioritize updating and adhering to industry security standards. Neglecting to implement the latest security practices and failing to meet recognized security standards can leave the platform susceptible to various security issues.</p></li><li><p><strong>Limited Resources for Security Measures:</strong><br>The lack of dedicated resources, both human and financial, allocated explicitly for implementing robust security measures can be a contributing factor. Insufficient investment in security infrastructure, tools, and personnel can hinder the platform's ability to address security concerns effectively.</p></li><li><p><strong>Potential Communication Gaps:</strong><br>There might be communication gaps or inadequate channels for reporting security vulnerabilities to the FiveM or cfx.re team.<br>Failure to establish efficient lines of communication can result in unaddressed security flaws and hinder the timely resolution of reported issues.</p></li><li><p><strong>Challenges in Balancing Security and Functionality:</strong><br>The developers of FiveM may face challenges in striking the right balance between security and providing a feature-rich experience for users.<br>Striving to offer extensive functionality while maintaining a secure environment can be complex, potentially leading to vulnerabilities if not executed effectively.</p></li></ol><p>To enhance the security of FiveM, the development team must invest in security expertise, actively update and adhere to security standards, allocate sufficient resources for security measures, establish effective communication channels for reporting vulnerabilities, and consistently balance functionality with robust security practices.</p><h2>The Most Toxic gaming community on the planet </h2><p class="msg msg--warning">This section has a personal option derived from publicly available information about the cfx.re development team and the FiveM gaming community  </p><p>The toxicity within the Fivem community is evident in how they treat young developers. Instead of providing support, guidance, and encouragement to budding talent, the cfx.re team seems to have taken a different approach. They have consistently undermined and crushed the spirit of these aspiring developers, making it extremely difficult for them to flourish.</p><p>Rather than nurturing a positive environment for creativity and growth, the Fivem community has become a breeding ground for hostility and negativity. Toxic behavior, such as harassment, bullying, doxing, and belittling, has become alarmingly prevalent.<br>It has created an atmosphere where young developers and players are discouraged from sharing their ideas and projects, fearing criticism and ridicule.</p><p>Furthermore, the cfx.re team's actions have fueled the fire of toxicity.<br>Instead of addressing the issue and taking steps to curb the toxic behavior within their community, they have perpetuated it.<br>Their indifference and lack of action have allowed toxicity to flourish, pushing away potential contributors and tarnishing the reputation of Fivem as a whole.</p><p>The impact of this toxic gaming community extends beyond just the young developers. It affects the entire player base, making the gaming experience unpleasant.<br>Toxicity breeds more toxicity, creating a vicious cycle that deters new players from joining and alienates existing ones. </p><h2>To Sum Up </h2><p>As a developer and gaming community owner who utilizes the cfx.re platform for server operations, I share your frustration regarding the issues.<br>Building and maintaining servers within a gaming community comes at a significant cost, not only in terms of finances but also in the time and effort invested to ensure the safety of players.</p><p>Witnessing the cfx.re development team repeatedly letting down their community is disheartening. The platform's shortcomings and security vulnerabilities can be particularly frustrating for individuals like yourself who have dedicated considerable resources to maintain a secure player environment.</p><p>The lack of timely resolutions, ongoing issues, and potential negligence on the part of the cfx.re team can lead to disappointment and annoyance. The trust placed in the platform, and its developers are undermined when community owners witness repeated failures and lapses in security.</p><p>As a community owner, prioritizing your players' safety and well-being is crucial.</p><p>While the frustrations are valid, staying informed about the platform's updates and security improvements is essential. Voicing concerns and engaging in constructive dialogue with the cfx.re team can also help advocate for necessary changes and improvements within the community.</p><p>Ultimately, the commitment to maintaining a safe and enjoyable gaming experience for your players remains paramount. Evaluating available options and taking proactive steps to address security concerns will contribute to your gaming community's long-term success and satisfaction.</p><p> </p></div><footer class="post__inner post__footer"><p class="post__last-updated">This article was updated on 02:30:42 14/05/23</p><div class="post__share"><h3>Share post:</h3><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fblog.thefourcraft.com%2Ffivems-granted-assets-security-backdoor%2Findex.html" class="js-share icon brands fa-facebook" rel="nofollow noopener noreferrer"><span class="label">Facebook</span> </a><a href="https://twitter.com/share?url=https%3A%2F%2Fblog.thefourcraft.com%2Ffivems-granted-assets-security-backdoor%2Findex.html&amp;via=thefourcraft&amp;text=FiveM's%20Granted%20Assets%20Security%20Backdoor%C2%A0" class="js-share icon brands fa-twitter" rel="nofollow noopener noreferrer"><span class="label">Twitter</span> </a><a href="https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fblog.thefourcraft.com%2Ffivems-granted-assets-security-backdoor%2Findex.html&amp;media=https%3A%2F%2Fblog.thefourcraft.com%2Fmedia%2Fposts%2F44%2FFiveMs-Granted-Assets-Security-Backdoor.png&amp;description=FiveM's%20Granted%20Assets%20Security%20Backdoor%C2%A0" class="js-share icon brands fa-pinterest" rel="nofollow noopener noreferrer"><span class="label">Pinterest</span> </a><a href="https://mix.com/add?url=https%3A%2F%2Fblog.thefourcraft.com%2Ffivems-granted-assets-security-backdoor%2Findex.html" class="js-share icon brands fa-mix" rel="nofollow noopener noreferrer"><span class="label">Mix</span> </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fblog.thefourcraft.com%2Ffivems-granted-assets-security-backdoor%2Findex.html" class="js-share icon brands fa-linkedin" rel="nofollow noopener noreferrer"><span class="label">LinkedIn</span> </a><a href="https://buffer.com/add?text=FiveM's%20Granted%20Assets%20Security%20Backdoor%C2%A0&amp;url=https%3A%2F%2Fblog.thefourcraft.com%2Ffivems-granted-assets-security-backdoor%2Findex.html" class="js-share icon brands fa-buffer" rel="nofollow noopener noreferrer"><span class="label">Buffer</span> </a><a href="https://api.whatsapp.com/send?text=FiveM's%20Granted%20Assets%20Security%20Backdoor%C2%A0 https%3A%2F%2Fblog.thefourcraft.com%2Ffivems-granted-assets-security-backdoor%2Findex.html" class="js-share icon brands fa-whatsapp" rel="nofollow noopener noreferrer"><span class="label">WhatsApp</span> </a><a href="https://news.ycombinator.com/submitlink?u=https%3A%2F%2Fblog.thefourcraft.com%2Ffivems-granted-assets-security-backdoor%2Findex.html&t=FiveM's%20Granted%20Assets%20Security%20Backdoor%C2%A0" class="js-share icon brands fa-hacker-news" rel="nofollow noopener noreferrer"><span class="label">[MISSING TRANSLATION]</span> </a><a href="https://medium.com/post?source=https%3A%2F%2Fblog.thefourcraft.com%2Ffivems-granted-assets-security-backdoor%2Findex.html&title=FiveM's%20Granted%20Assets%20Security%20Backdoor%C2%A0" class="js-share icon brands fa-medium" rel="nofollow noopener noreferrer"><span class="label">[MISSING TRANSLATION]</span> </a><a href="https://mastodon.social/share?text=FiveM's%20Granted%20Assets%20Security%20Backdoor%C2%A0&amp;url=https%3A%2F%2Fblog.thefourcraft.com%2Ffivems-granted-assets-security-backdoor%2Findex.html" class="js-share icon brands fa-mastodon" rel="nofollow noopener noreferrer"><span class="label">[MISSING TRANSLATION]</span> </a><a href="https://vk.com/share.php?url=https%3A%2F%2Fblog.thefourcraft.com%2Ffivems-granted-assets-security-backdoor%2Findex.html&amp;title=FiveM's%20Granted%20Assets%20Security%20Backdoor%C2%A0" class="js-share icon brands fa-vk" rel="nofollow noopener noreferrer"><span class="label">[MISSING TRANSLATION]</span> </a><a href="https://www.reddit.com/submit?url=https%3A%2F%2Fblog.thefourcraft.com%2Ffivems-granted-assets-security-backdoor%2Findex.html&amp;title=FiveM's%20Granted%20Assets%20Security%20Backdoor%C2%A0" class="js-share icon brands fa-reddit" rel="nofollow noopener noreferrer"><span class="label">[MISSING TRANSLATION]</span> </a><a href="https://www.tumblr.com/widgets/share/tool?canonicalUrl=https%3A%2F%2Fblog.thefourcraft.com%2Ffivems-granted-assets-security-backdoor%2Findex.html&amp;title=FiveM's%20Granted%20Assets%20Security%20Backdoor%C2%A0" class="js-share icon brands fa-tumblr" rel="nofollow noopener noreferrer"><span class="label">[MISSING TRANSLATION]</span> </a><a href="https://www.xing.com/app/user?op=share;url=https%3A%2F%2Fblog.thefourcraft.com%2Ffivems-granted-assets-security-backdoor%2Findex.html" class="js-share icon brands fa-xing" rel="nofollow noopener noreferrer"><span class="label">[MISSING TRANSLATION]</span> </a><a href="mailto:?subject=FiveM's%20Granted%20Assets%20Security%20Backdoor%C2%A0&amp;body=https%3A%2F%2Fblog.thefourcraft.com%2Ffivems-granted-assets-security-backdoor%2Findex.html" class="js-share icon fa-envelope" rel="nofollow noopener noreferrer"><span class="label">[MISSING TRANSLATION]</span></a></div><div class="post__tag"><ul><li><strong>Tagged in:</strong></li><li><a href="https://blog.thefourcraft.com/tags/aws/index.html">AWS</a></li><li><a href="https://blog.thefourcraft.com/tags/cloud-security/index.html">Cloud Security</a></li><li><a href="https://blog.thefourcraft.com/tags/fivem/index.html">FiveM</a></li><li><a href="https://blog.thefourcraft.com/tags/security/index.html">Security</a></li></ul></div><div class="post__bio"><img src="https://www.gravatar.com/avatar/a032a3cff682f8cfff78d0a88a1f9336?s&#x3D;240" loading="lazy" height="240" width="240" alt="thefourCraft"><div><h3><a href="https://blog.thefourcraft.com/authors/david/index.html" class="invert" rel="author">thefourCraft</a></h3><p>Hi, It&#x27;s me David... Online I go By the name thefourCraft to protect my identify</p></div></div></footer></article></div></div><div id="sidebar"><div class="inner"><div id="search" class="alt"></div><nav id="menu"><header class="major"><h2>Menu</h2></header><ul><li><a href="https://blog.thefourcraft.com/index.html" target="_self">Home</a></li><li><a href="https://www.linkedin.com/build-relation/newsletter-follow?entityUrn&#x3D;7062371340606930944" target="_blank">Subscribe on LinkedIn</a></li><li><a href="https://blog.thefourcraft.com/tags/index.html" target="_self">Topics</a></li><li><a href="https://www.thefourcraft.com" target="_self">Main Website</a></li><li><a href="https://www.thefourcraft.com/privacy-policy.html" target="_self">Privacy Policy</a></li></ul></nav><section><header class="major"><h2>Get in touch</h2></header><h1>Welcome To DF - Blogs</h1><p>I'm David, an 18-year-old self-taught DevOps and QA engineer passionate about technology and gaming. As a Webmaster <a href="https://aidock.net" target="_blank" rel="noopener">@AiDock</a>, I design, develop, and maintain the company's website while implementing the latest web technologies. I also volunteer with <a href="https://ims-network.org" target="_blank" rel="noopener">@ims-network</a> to build and sustain free game servers.</p><p><a class="libutton" href="https://www.linkedin.com/build-relation/newsletter-follow?entityUrn=7062371340606930944" target="_blank" rel="noopener">Subscribe on LinkedIn</a></p></section><footer id="footer"><p class="copyright">© DF. All rights are reserved under applicable copyright laws.<br>This site operates under an open-source license, specifically licensed by CC BY NC 4, which governs its usage and distribution.</p><p class="copyright">The site is powered by <a href="https://pages.cloudflare.com/" target="_blank" rel="noopener">Cloudflare Pages</a>, ensuring secure and reliable access.<br><br>It is important to note that all the tips or blogs provided on this website solely reflect my personal opinions and should not be construed as professional recommendations.<br> </p></footer></div></div></div><script src="https://blog.thefourcraft.com/assets/js/jquery.min.js?v=7c14a783dfeb3d238ccd3edd840d82ee"></script><script src="https://blog.thefourcraft.com/assets/js/browser.min.js?v=c07298dd19048a8a69ad97e754dfe8d0"></script><script src="https://blog.thefourcraft.com/assets/js/breakpoints.min.js?v=81a479eb099e3b187613943b085923b8"></script><script src="https://blog.thefourcraft.com/assets/js/util.min.js?v=cbdaf7c20ac2883c77ae23acfbabd47e"></script><script src="https://blog.thefourcraft.com/assets/js/main.min.js?v=08add7f6d435054ad38ec38d7cf8be40"></script><script>var images=document.querySelectorAll("img[loading]");for(var i=0;i<images.length;i++){if(images[i].complete){images[i].classList.add("is-loaded")}else{images[i].addEventListener("load",function(){this.classList.add("is-loaded")},false)}};</script><div class="pcb" data-behaviour="badge" data-behaviour-link="#cookie-settings" data-revision="1" data-config-ttl="30" data-debug-mode="false"><div role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="pcb-title" aria-describedby="pcb-txt" class="pcb__banner"><div class="pcb__inner"><div id="pcb-title" role="heading" aria-level="2" class="pcb__title">My Blogging Website Is Using Cookies</div><div id="pcb-txt" class="pcb__txt">Select which cookies to opt-in to via the checkboxes below; our website uses cookies to examine site traffic and user activity while on our site, for marketing, and to provide social media functionality. <a href="https://www.thefourcraft.com/privacy-policy.html">More details...</a></div><div class="pcb__buttons"><button type="button" class="pcb__btn pcb__btn--link pcb__btn--configure" aria-haspopup="dialog">Manage preferences</button> <button type="button" class="pcb__btn pcb__btn--reject">Reject</button> <button type="button" class="pcb__btn pcb__btn--solid pcb__btn--accept">Accept all</button></div></div></div><div class="pcb__popup" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="pcb-popup-title"><div class="pcb__popup__wrapper"><div class="pcb__inner pcb__popup__inner"><div class="pcb__popup__heading"><div id="pcb-popup-title" role="heading" aria-level="2" class="pcb__title">Cookie settings</div><button class="pcb__popup__close" aria-label="Close"></button></div><div class="pcb__popup__content"><div class="pcb__txt pcb__popup__txt">I use cookies to enhance your browsing experience and security and analyze traffic. By clicking "Accept All", you consent to our use of cookies. <a href="https://www.thefourcraft.com/privacy-policy.html">More details...</a></div><ul class="pcb__groups"><li class="pcb__group"><details><summary class="pcb__group__title">Comments</summary><p class="pcb__group__txt">If You Want To Enable The 3rd Party Comments Integration</p></details><div class="pcb__popup__switch"><input type="checkbox" data-group-name="comments" id="comments-cookies"> <label for="comments-cookies">Comments</label></div></li><li class="pcb__group"><details><summary class="pcb__group__title">Functions</summary><p class="pcb__group__txt">If You Want Site 3rd Party Search</p></details><div class="pcb__popup__switch"><input type="checkbox" data-group-name="functions" id="functions-cookies"> <label for="functions-cookies">Functions</label></div></li><li class="pcb__group"><details><summary class="pcb__group__title">Analytics</summary><p class="pcb__group__txt">Enabling IMS - Analytics is subjected to IMS -Network's privacy policy https://legal.ims-network.net/privacy-policy.html</p></details><div class="pcb__popup__switch"><input type="checkbox" data-group-name="analytics" id="analytics-cookies"> <label for="analytics-cookies">Analytics</label></div></li><li class="pcb__group"><details><summary class="pcb__group__title">YouTube</summary><p class="pcb__group__txt">YouTubes & Google's Data Collection, because this website might have videos that are streamed with YouTube</p></details><div class="pcb__popup__switch"><input type="checkbox" data-group-name="youtube" id="youtube-cookies"> <label for="youtube-cookies">YouTube</label></div></li></ul></div><div class="pcb__buttons pcb__popup__buttons"><button type="button" class="pcb__btn pcb__btn--solid pcb__btn--accept">Accept all</button> <button type="button" class="pcb__btn pcb__btn--reject">Reject all</button> <button type="button" class="pcb__btn pcb__btn--save">Save settings</button></div></div></div></div><div class="pcb__overlay" aria-hidden="true"></div><button class="pcb__badge" aria-label="Cookie Policy" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" width="40" height="40" viewBox="0 0 23 23" fill="currentColor"><path d="M21.41 12.71c-.08-.01-.15 0-.22 0h-.03c-.03 0-.05 0-.08.01-.07 0-.13.01-.19.04-.52.21-1.44.19-2.02-.22-.44-.31-.65-.83-.62-1.53a.758.758 0 0 0-.27-.61.73.73 0 0 0-.65-.14c-1.98.51-3.49.23-4.26-.78-.82-1.08-.73-2.89.24-4.49.14-.23.14-.52 0-.75a.756.756 0 0 0-.67-.36c-.64.03-1.11-.1-1.31-.35-.19-.26-.13-.71-.01-1.29.04-.18.06-.38.03-.59-.05-.4-.4-.7-.81-.66C5.1 1.54 1 6.04 1 11.48 1 17.28 5.75 22 11.6 22c5.02 0 9.39-3.54 10.39-8.42.08-.4-.18-.78-.58-.87Zm-9.81 7.82c-5.03 0-9.12-4.06-9.12-9.06 0-4.34 3.05-8 7.25-8.86-.08.7.05 1.33.42 1.81.24.32.66.67 1.38.84-.76 1.86-.65 3.78.36 5.11.61.81 2.03 2 4.95 1.51.18.96.71 1.54 1.18 1.87.62.43 1.38.62 2.1.62.05 0 .09 0 .13-.01-1.23 3.64-4.7 6.18-8.64 6.18ZM13 17c0 .55-.45 1-1 1s-1-.45-1-1 .45-1 1-1 1 .45 1 1Zm5.29-12.3a.99.99 0 0 1-.29-.71c0-.55.45-.99 1-.99a1 1 0 0 1 .71.3c.19.19.29.44.29.71 0 .55-.45.99-1 .99a1 1 0 0 1-.71-.3ZM9 13.5c0 .83-.67 1.5-1.5 1.5S6 14.33 6 13.5 6.67 12 7.5 12s1.5.67 1.5 1.5Zm3.25.81a.744.744 0 0 1-.06-1.05c.28-.32.75-.34 1.05-.06.31.28.33.75.05 1.06-.15.16-.35.25-.56.25-.18 0-.36-.06-.5-.19ZM8.68 7.26c.41.37.44 1 .07 1.41-.2.22-.47.33-.75.33a.96.96 0 0 1-.67-.26c-.41-.37-.44-1-.07-1.41.37-.42 1-.45 1.41-.08Zm11.48 1.88c.18-.19.52-.19.7 0 .05.04.09.1.11.16.03.06.04.12.04.19 0 .13-.05.26-.15.35-.09.1-.22.15-.35.15s-.26-.05-.35-.15a.355.355 0 0 1-.11-.16.433.433 0 0 1-.04-.19c0-.13.05-.26.15-.35Zm-4.93-1.86a.75.75 0 1 1 1.059-1.06.75.75 0 0 1-1.059 1.06Z"/></svg></button></div><script>(function(win) {
    if (!document.querySelector('.pcb')) {
        return;
    }

    var cbConfig = {
        behaviour: document.querySelector('.pcb').getAttribute('data-behaviour'),
        behaviourLink: document.querySelector('.pcb').getAttribute('data-behaviour-link'),
        revision: document.querySelector('.pcb').getAttribute('data-revision'),
        configTTL: parseInt(document.querySelector('.pcb').getAttribute('data-config-ttl'), 10),
        debugMode: document.querySelector('.pcb').getAttribute('data-debug-mode') === 'true',
        initialState: null,
        previouslyAccepted: []
    };

    var cbUI = {
        wrapper: document.querySelector('.pcb'),
        banner: {
            element: null,
            btnAccept: null,
            btnReject: null,
            btnConfigure: null
        },
        popup: {
            element: null,
            btnClose: null,
            btnSave: null,
            btnAccept: null,
            btnReject: null,
            checkboxes: null,
        },
        overlay: null,
        badge: null,
        blockedScripts: document.querySelectorAll('script[type^="gdpr-blocker/"]'),
        triggerLinks: cbConfig.behaviourLink ? document.querySelectorAll('a[href*="' + cbConfig.behaviourLink + '"]') : null
    };

    function initUI () {
        // setup banner elements
        cbUI.banner.element = cbUI.wrapper.querySelector('.pcb__banner');
        cbUI.banner.btnAccept = cbUI.banner.element.querySelector('.pcb__btn--accept');
        cbUI.banner.btnReject = cbUI.banner.element.querySelector('.pcb__btn--reject');
        cbUI.banner.btnConfigure = cbUI.banner.element.querySelector('.pcb__btn--configure');

        // setup popup elements
        if (cbUI.wrapper.querySelector('.pcb__popup')) {
            cbUI.popup.element = cbUI.wrapper.querySelector('.pcb__popup');
            cbUI.popup.btnClose = cbUI.wrapper.querySelector('.pcb__popup__close');
            cbUI.popup.btnSave = cbUI.popup.element.querySelector('.pcb__btn--save');
            cbUI.popup.btnAccept = cbUI.popup.element.querySelector('.pcb__btn--accept');
            cbUI.popup.btnReject = cbUI.popup.element.querySelector('.pcb__btn--reject');
            cbUI.popup.checkboxes = cbUI.popup.element.querySelector('input[type="checkbox"]');
            // setup overlay
            cbUI.overlay = cbUI.wrapper.querySelector('.pcb__overlay');
        }

        cbUI.badge = cbUI.wrapper.querySelector('.pcb__badge');

        if (cbConfig.behaviour.indexOf('link') > -1) {
            for (var i = 0; i < cbUI.triggerLinks.length; i++) {
                cbUI.triggerLinks[i].addEventListener('click', function(e) {
                    e.preventDefault();
                    showBannerOrPopup();
                });
            }
        }
    }

    function initState () {
        var lsKeyName = getConfigName();
        var currentConfig = localStorage.getItem(lsKeyName);
        var configIsFresh = checkIfConfigIsFresh();

        if (!configIsFresh || currentConfig === null) {
            if (cbConfig.debugMode) {
                console.log('🍪 Config not found, or configuration expired');
            }

            showBanner();
        } else if (typeof currentConfig === 'string') {
            if (cbConfig.debugMode) {
                console.log('🍪 Config founded');
            }

            showBadge();

            if (cbUI.popup.element) {
                var allowedGroups = currentConfig.split(',');
                var checkedCheckboxes = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');

                for (var j = 0; j < checkedCheckboxes.length; j++) {
                    var name = checkedCheckboxes[j].getAttribute('data-group-name');

                    if (name && name !== '-' && allowedGroups.indexOf(name) === -1) {
                        checkedCheckboxes[j].checked = false;
                    }
                }

                for (var i = 0; i < allowedGroups.length; i++) {
                    var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + allowedGroups[i] + '"]');

                    if (checkbox) {
                        checkbox.checked = true;
                    }

                    allowCookieGroup(allowedGroups[i]);
                }
            }
        }

        setTimeout(function () {
            cbConfig.initialState = getInitialStateOfConsents();
        }, 0);
    }

    function checkIfConfigIsFresh () {
        var lastConfigSave = localStorage.getItem('publii-gdpr-cookies-config-save-date');

        if (lastConfigSave === null) {
            return false;
        }

        lastConfigSave = parseInt(lastConfigSave, 10);

        if (lastConfigSave === 0) {
            return true;
        }

        if (+new Date() - lastConfigSave < cbConfig.configTTL * 24 * 60 * 60 * 1000) {
            return true;
        }

        return false;
    }

    function initBannerEvents () {
        cbUI.banner.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('banner');
            showBadge();
        }, false);

        if (cbUI.banner.btnReject) {
            cbUI.banner.btnReject.addEventListener('click', function (e) {
                e.preventDefault();
                rejectAllCookies();
                showBadge();
            }, false);
        }

        if (cbUI.banner.btnConfigure) {
            cbUI.banner.btnConfigure.addEventListener('click', function (e) {
                e.preventDefault();
                hideBanner();
                showAdvancedPopup();
                showBadge();
            }, false);
        }
    }

    function initPopupEvents () {
        if (!cbUI.popup.element) {
            return;
        }

        cbUI.overlay.addEventListener('click', function (e) {
            hideAdvancedPopup();
        }, false);

        cbUI.popup.element.addEventListener('click', function (e) {
            e.stopPropagation();
        }, false);

        cbUI.popup.btnAccept.addEventListener('click', function (e) {
            e.preventDefault();
            acceptAllCookies('popup');
        }, false);

        cbUI.popup.btnReject.addEventListener('click', function (e) {
            e.preventDefault();
            rejectAllCookies();
        }, false);

        cbUI.popup.btnSave.addEventListener('click', function (e) {
            e.preventDefault();
            saveConfiguration();
        }, false);

        cbUI.popup.btnClose.addEventListener('click', function (e) {
            e.preventDefault();
            hideAdvancedPopup();
        }, false);
    }

    function initBadgeEvents () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.addEventListener('click', function (e) {
            showBannerOrPopup();
        }, false);
    }

    initUI();
    initState();
    initBannerEvents();
    initPopupEvents();
    initBadgeEvents();

    /**
     * API
     */
    function addScript (src, inline) {
        var newScript = document.createElement('script');

        if (src) {
            newScript.setAttribute('src', src);
        }

        if (inline) {
            newScript.text = inline;
        }

        document.body.appendChild(newScript);
    }

    function allowCookieGroup (allowedGroup) {
        var scripts = document.querySelectorAll('script[type="gdpr-blocker/' + allowedGroup + '"]');
        cbConfig.previouslyAccepted.push(allowedGroup);
    
        for (var j = 0; j < scripts.length; j++) {
            addScript(scripts[j].src, scripts[j].text);
        }

        var groupEvent = new Event('publii-cookie-banner-unblock-' + allowedGroup);
        document.body.dispatchEvent(groupEvent);
        unlockEmbeds(allowedGroup);

        if (cbConfig.debugMode) {
            console.log('🍪 Allowed group: ' + allowedGroup);
        }
    }

    function showBannerOrPopup () {
        if (cbUI.popup.element) {
            showAdvancedPopup();
        } else {
            showBanner();
        }
    }

    function showAdvancedPopup () {
        cbUI.popup.element.classList.add('is-visible');
        cbUI.overlay.classList.add('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'false');
        cbUI.overlay.setAttribute('aria-hidden', 'false');
    }

    function hideAdvancedPopup () {
        cbUI.popup.element.classList.remove('is-visible');
        cbUI.overlay.classList.remove('is-visible');
        cbUI.popup.element.setAttribute('aria-hidden', 'true');
        cbUI.overlay.setAttribute('aria-hidden', 'true');
    }

    function showBanner () {
        cbUI.banner.element.classList.add('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'false');
    }

    function hideBanner () {
        cbUI.banner.element.classList.remove('is-visible');
        cbUI.banner.element.setAttribute('aria-hidden', 'true');
    }

    function showBadge () {
        if (!cbUI.badge) {
            return;
        }

        cbUI.badge.classList.add('is-visible');
        cbUI.badge.setAttribute('aria-hidden', 'false');
    }

    function getConfigName () {
        var lsKeyName = 'publii-gdpr-allowed-cookies';

        if (cbConfig.revision) {
            lsKeyName = lsKeyName + '-v' + parseInt(cbConfig.revision, 10);
        }

        return lsKeyName;
    }

    function storeConfiguration (allowedGroups) {
        var lsKeyName = getConfigName();
        var dataToStore = allowedGroups.join(',');
        localStorage.setItem(lsKeyName, dataToStore);

        if (cbConfig.configTTL === 0) {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', 0);

            if (cbConfig.debugMode) {
                console.log('🍪 Store never expiring configuration');
            }
        } else {
            localStorage.setItem('publii-gdpr-cookies-config-save-date', +new Date());
        }
    }

    function getInitialStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 Initial state: ' + groups.join(', '));
        }

        return groups;
    }

    function getCurrentStateOfConsents () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]:checked');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 State to save: ' + groups.join(', '));
        }

        return groups;
    }

    function getAllGroups () {
        if (!cbUI.popup.element) {
            return [];
        }

        var checkedGroups = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');
        var groups = [];

        for (var i = 0; i < checkedGroups.length; i++) {
            var allowedGroup = checkedGroups[i].getAttribute('data-group-name');

            if (allowedGroup !== '') {
                groups.push(allowedGroup);
            }
        }

        return groups;
    }

    function acceptAllCookies (source) {
        var groupsToAccept = getAllGroups();
        storeConfiguration(groupsToAccept);

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        if (cbUI.popup.element) {
            var checkboxesToCheck = cbUI.popup.element.querySelectorAll('input[type="checkbox"]');

            for (var j = 0; j < checkboxesToCheck.length; j++) {
                checkboxesToCheck[j].checked = true;
            }
        }

        if (cbConfig.debugMode) {
            console.log('🍪 Accept all cookies: ', groupsToAccept.join(', '));
        }

        if (source === 'popup') {
            hideAdvancedPopup();
        } else if (source === 'banner') {
            hideBanner();
        }
    }

    function rejectAllCookies () {
        if (cbConfig.debugMode) {
            console.log('🍪 Reject all cookies');
        }

        storeConfiguration([]);
        setTimeout(function () {
            window.location.reload();
        }, 100);
    }

    function saveConfiguration () {
        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('🍪 Save new config: ', groupsToAccept.join(', '));
        }

        if (reloadIsNeeded(groupsToAccept)) {
            setTimeout(function () {
                window.location.reload();
            }, 100);
            return;
        }

        for (var i = 0; i < groupsToAccept.length; i++) {
            var group = groupsToAccept[i];

            if (cbConfig.initialState.indexOf(group) > -1 || cbConfig.previouslyAccepted.indexOf(group) > -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Skip previously activated group: ' + group);
                }

                continue;
            }

            allowCookieGroup(group);
        }

        hideAdvancedPopup();
    }

    function reloadIsNeeded (groupsToAccept) {
        // check if user rejected consent for initial groups
        var initialGroups = cbConfig.initialState;
        var previouslyAcceptedGroups = cbConfig.previouslyAccepted;
        var groupsToCheck = initialGroups.concat(previouslyAcceptedGroups);

        for (var i = 0; i < groupsToCheck.length; i++) {
            var groupToCheck = groupsToCheck[i];

            if (groupsToAccept.indexOf(groupToCheck) === -1) {
                if (cbConfig.debugMode) {
                    console.log('🍪 Reload is needed due lack of: ', groupToCheck);
                }

                return true;
            }
        }

        return false;
    }

    function unlockEmbeds (cookieGroup) {
        var iframesToUnlock = document.querySelectorAll('.pec-wrapper[data-consent-group-id="' + cookieGroup + '"]');

        for (var i = 0; i < iframesToUnlock.length; i++) {
            var iframeWrapper = iframesToUnlock[i];
            iframeWrapper.querySelector('.pec-overlay').classList.remove('is-active');
            iframeWrapper.querySelector('.pec-overlay').setAttribute('aria-hidden', 'true');
            var iframe = iframeWrapper.querySelector('iframe');
            iframe.setAttribute('src', iframe.getAttribute('data-consent-src'));
        }
    }

    win.publiiEmbedConsentGiven = function (cookieGroup) {
        // it will unlock embeds
        allowCookieGroup(cookieGroup);

        var checkbox = cbUI.popup.element.querySelector('input[type="checkbox"][data-group-name="' + cookieGroup + '"]');

        if (checkbox) {
            checkbox.checked = true;
        }

        var groupsToAccept = getCurrentStateOfConsents();
        storeConfiguration(groupsToAccept);

        if (cbConfig.debugMode) {
            console.log('🍪 Save new config: ', groupsToAccept.join(', '));
        }
    }
})(window);</script></body></html>